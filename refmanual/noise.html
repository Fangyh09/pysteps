
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Noise generators (pysteps.noise) &#8212; pysteps 0.2 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Post-processing of forecasts (pysteps.postprocessing)" href="postprocessing.html" />
    <link rel="prev" title="Scale-based decomposition of precipitation fields (pysteps.cascade)" href="cascade.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-processing of forecasts (pysteps.postprocessing)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cascade.html" title="Scale-based decomposition of precipitation fields (pysteps.cascade)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysteps 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="noise-generators-pysteps-noise">
<span id="pysteps-noise"></span><h1>Noise generators (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pysteps.noise</span></code>)<a class="headerlink" href="#noise-generators-pysteps-noise" title="Permalink to this headline">¶</a></h1>
<p>Methods for generating stochastic perturbations of 2d precipitation and velocity
fields.</p>
<div class="section" id="module-pysteps.noise.interface">
<span id="pysteps-noise-interface"></span><h2>pysteps.noise.interface<a class="headerlink" href="#module-pysteps.noise.interface" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pysteps.noise.interface.get_method">
<code class="descclassname">pysteps.noise.interface.</code><code class="descname">get_method</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.interface.get_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Return two callable functions to initialize and generate 2d perturbations
of precipitation  or velocity fields.</p>
<p>Methods for precipitation fields:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>parametric</td>
<td>this global generator uses parametric Fourier
filering (power-law model)</td>
</tr>
<tr class="row-odd"><td>nonparametric</td>
<td>this global generator uses nonparametric Fourier
filering</td>
</tr>
<tr class="row-even"><td>ssft</td>
<td>this local generator uses the short-space Fourier
filtering</td>
</tr>
<tr class="row-odd"><td>nested</td>
<td>this local generator uses a nested Fourier filtering</td>
</tr>
</tbody>
</table>
<p>Methods for velocity fields:</p>
<table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>bps</td>
<td>The method described in [BPS2006], where
time-dependent velocity perturbations are sampled
from the exponential distribution</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pysteps-noise-fftgenerators">
<h2>pysteps.noise.fftgenerators<a class="headerlink" href="#pysteps-noise-fftgenerators" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_fft_filter" title="pysteps.noise.fftgenerators.initialize_nonparam_2d_fft_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_nonparam_2d_fft_filter</span></code></a>(X,&nbsp;**kwargs)</td>
<td>Takes one ore more 2d input fields and produces one non-paramtric, global and anasotropic fourier filter.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.initialize_param_2d_fft_filter" title="pysteps.noise.fftgenerators.initialize_param_2d_fft_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_param_2d_fft_filter</span></code></a>(X,&nbsp;**kwargs)</td>
<td>Takes one ore more 2d input fields, fits two spectral slopes, beta1 and beta2, to produce one parametric, global and isotropic fourier filter.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.generate_noise_2d_fft_filter" title="pysteps.noise.fftgenerators.generate_noise_2d_fft_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_noise_2d_fft_filter</span></code></a>(F[,&nbsp;randstate,&nbsp;…])</td>
<td>Produces a field of correlated noise using global Fourier filtering.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_ssft_filter" title="pysteps.noise.fftgenerators.initialize_nonparam_2d_ssft_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_nonparam_2d_ssft_filter</span></code></a>(X,&nbsp;**kwargs)</td>
<td>Function to compute the local Fourier filters using the Short-Space Fourier filtering approach.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_nested_filter" title="pysteps.noise.fftgenerators.initialize_nonparam_2d_nested_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_nonparam_2d_nested_filter</span></code></a>(X[,&nbsp;…])</td>
<td>Function to compute the local Fourier filters using a nested approach.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.generate_noise_2d_ssft_filter" title="pysteps.noise.fftgenerators.generate_noise_2d_ssft_filter"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_noise_2d_ssft_filter</span></code></a>(F[,&nbsp;…])</td>
<td>Function to compute the locally correlated noise using a nested approach.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.noise.fftgenerators.build_2D_tapering_function" title="pysteps.noise.fftgenerators.build_2D_tapering_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_2D_tapering_function</span></code></a>(win_size[,&nbsp;win_type])</td>
<td>Produces two-dimensional tapering function for rectangular fields.</td>
</tr>
</tbody>
</table>
<span class="target" id="module-pysteps.noise.fftgenerators"></span><p>Methods for noise generators based on FFT filtering of white noise.</p>
<p>The methods in this module implement the following interface for filter
initialization depending on their parametric or nonparametric nature:</p>
<blockquote>
<div><p>initialize_param_2d_xxx_filter(X, <a href="#id2"><span class="problematic" id="id3">**</span></a>kwargs)</p>
<p>or</p>
<p>initialize_nonparam_2d_xxx_filter(X, <a href="#id4"><span class="problematic" id="id5">**</span></a>kwargs)</p>
</div></blockquote>
<p>where X is an array of shape (m, n) that defines the target field and optional
parameters are supplied as keyword arguments.</p>
<p>The output of each initialization method is a dictionary containing the keys F
and input_shape. The first is a two-dimensional array of shape (m, int(n/2)+1)
that defines the filter. The second one is the shape of the input field for the
filter.</p>
<p>The methods in this module implement the following interface for the generation
of correlated noise:</p>
<blockquote>
<div>generate_noise_2d_xxx_filter(F, randstate=np.random, seed=None, <a href="#id6"><span class="problematic" id="id7">**</span></a>kwargs)</div></blockquote>
<p>where F (m, n) is a filter returned from the correspondign initialization method,
and randstate and seed can be used to set the random generator and its seed.
Additional keyword arguments can be included as a dictionary.</p>
<p>The output of each generator method is a two-dimensional array containing the
field of correlated noise cN of shape (m, n).</p>
<dl class="function">
<dt id="pysteps.noise.fftgenerators.build_2D_tapering_function">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">build_2D_tapering_function</code><span class="sig-paren">(</span><em>win_size</em>, <em>win_type='flat-hanning'</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.build_2D_tapering_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces two-dimensional tapering function for rectangular fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>win_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple of int</span></dt>
<dd><p class="first last">Size of the tapering window as two-element tuple of integers.</p>
</dd>
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">str</span></dt>
<dd><p class="first last">Name of the tapering window type (hanning, flat-hanning)</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>w2d</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A two-dimensional numpy array containing the 2D tapering function.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.generate_noise_2d_fft_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">generate_noise_2d_fft_filter</code><span class="sig-paren">(</span><em>F</em>, <em>randstate=&lt;module 'numpy.random' from '/top/college/academic/ECE/spulkkin/home/anaconda3/lib/python3.7/site-packages/numpy/random/__init__.py'&gt;</em>, <em>seed=None</em>, <em>fft_method=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.generate_noise_2d_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a field of correlated noise using global Fourier filtering.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">A filter object returned by initialize_param_2d_fft_filter or
initialize_nonparam_2d_fft_filter. All values in the filter array are
required to be finite.</p>
</dd>
<dt><strong>randstate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mtrand.RandomState</span></dt>
<dd><p class="first last">Optional random generator to use. If set to None, use numpy.random.</p>
</dd>
<dt><strong>seed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Value to set a seed for the generator. None will not set the seed.</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A two-dimensional numpy array of stationary correlated noise.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.generate_noise_2d_ssft_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">generate_noise_2d_ssft_filter</code><span class="sig-paren">(</span><em>F</em>, <em>randstate=&lt;module 'numpy.random' from '/top/college/academic/ECE/spulkkin/home/anaconda3/lib/python3.7/site-packages/numpy/random/__init__.py'&gt;</em>, <em>seed=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.generate_noise_2d_ssft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the locally correlated noise using a nested approach.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A filter object returned by initialize_nonparam_2d_nested_filter or
initialize_nonparam_2d_ssft_filter. The filter is a four-dimensional
array containing the 2d fourier filters distributed over a 2d spatial
grid.</p>
</dd>
<dt><strong>randstate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mtrand.RandomState</span></dt>
<dd><p class="first last">Optional random generator to use. If set to None, use numpy.random.</p>
</dd>
<dt><strong>seed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Value to set a seed for the generator. None will not set the seed.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>N</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A two-dimensional numpy array of non-stationary correlated noise.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>overlap</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Percentage overlap [0-1] between successive windows.
Default : 0.2</p>
</dd>
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string [‘hanning’, ‘flat-hanning’]</span></dt>
<dd><p class="first last">Type of window used for localization.
Default : flat-hanning</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.initialize_nonparam_2d_fft_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">initialize_nonparam_2d_fft_filter</code><span class="sig-paren">(</span><em>X</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes one ore more 2d input fields and produces one non-paramtric, global
and anasotropic fourier filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Two- or three-dimensional array containing one or more input fields.
All values are required to be finite. If more than one field are passed,
the average fourier filter is returned. It assumes that fields are stacked
by the first axis: [nr_fields, y, x].</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A two-dimensional array containing the non-parametric filter.
It can be passed to generate_noise_2d_fft_filter().</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Optional tapering function to be applied to X.
Default : flat-hanning</p>
</dd>
<dt><strong>donorm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Option to normalize the real and imaginary parts.
Default : False</p>
</dd>
<dt><strong>rm_rdisc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether or not to remove the rain/no-rain disconituity. It assumes no-rain
pixels are assigned with lowest value.</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.initialize_nonparam_2d_nested_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">initialize_nonparam_2d_nested_filter</code><span class="sig-paren">(</span><em>X</em>, <em>gridres=1.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_nested_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the local Fourier filters using a nested approach.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Two- or three-dimensional array containing one or more input fields.
All values are required to be finite.
If more than one field are passed, the average fourier filter is returned.
It assumes that fields are stacked by the first axis: [nr_fields, y, x].</p>
</dd>
<dt><strong>gridres</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Grid resolution in km.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Four-dimensional array containing the 2d fourier filters distributed over
a 2d spatial grid.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>max_level</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Localization parameter. 0: global noise, &gt;0: increasing degree of localization.
Default : 3</p>
</dd>
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string [‘hanning’, ‘flat-hanning’]</span></dt>
<dd><p class="first last">Type of window used for localization.
Default : flat-hanning</p>
</dd>
<dt><strong>war_thr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float [0;1]</span></dt>
<dd><p class="first last">Threshold for the minimum fraction of rain needed for computing the FFT.
Default : 0.1</p>
</dd>
<dt><strong>rm_rdisc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether or not to remove the rain/no-rain disconituity. It assumes no-rain
pixels are assigned with lowest value.</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.initialize_nonparam_2d_ssft_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">initialize_nonparam_2d_ssft_filter</code><span class="sig-paren">(</span><em>X</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.initialize_nonparam_2d_ssft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute the local Fourier filters using the Short-Space Fourier
filtering approach.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Two- or three-dimensional array containing one or more input fields.
All values are required to be finite. If more than one field are passed,
the average fourier filter is returned. It assumes that fields are stacked
by the first axis: [nr_fields, y, x].</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Four-dimensional array containing the 2d fourier filters distributed over
a 2d spatial grid.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>win_size</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int or two-element tuple of ints</span></dt>
<dd><p class="first last">Size-length of the window to compute the SSFT.
Default : (128, 128)</p>
</dd>
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string [‘hanning’, ‘flat-hanning’]</span></dt>
<dd><p class="first last">Type of window used for localization.
Default : flat-hanning</p>
</dd>
<dt><strong>overlap</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float [0,1[</span></dt>
<dd><p class="first last">The proportion of overlap to be applied between successive windows.
Default : 0.3</p>
</dd>
<dt><strong>war_thr</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float [0,1]</span></dt>
<dd><p class="first last">Threshold for the minimum fraction of rain needed for computing the FFT.
Default : 0.1</p>
</dd>
<dt><strong>rm_rdisc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether or not to remove the rain/no-rain disconituity. It assumes no-rain
pixels are assigned with lowest value.</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p class="rubric">References</p>
<p>[NBSG2017]</p>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.fftgenerators.initialize_param_2d_fft_filter">
<code class="descclassname">pysteps.noise.fftgenerators.</code><code class="descname">initialize_param_2d_fft_filter</code><span class="sig-paren">(</span><em>X</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.fftgenerators.initialize_param_2d_fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes one ore more 2d input fields, fits two spectral slopes, beta1 and beta2,
to produce one parametric, global and isotropic fourier filter.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">Two- or three-dimensional array containing one or more input fields.
All values are required to be finite. If more than one field are passed,
the average fourier filter is returned. It assumes that fields are stacked
by the first axis: [nr_fields, y, x].</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first docutils">
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array-like</span></dt>
<dd><p class="first last">A two-dimensional array containing the parametric filter.
It can be passed to generate_noise_2d_fft_filter().</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">Other Parameters:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><dl class="first last docutils">
<dt><strong>win_type</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">Optional tapering function to be applied to X.
Default : flat-hanning</p>
</dd>
<dt><strong>model</strong> <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd><p class="first last">The parametric model to be used to fit the power spectrum of X.
Default : power-law</p>
</dd>
<dt><strong>weighted</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether or not to apply the sqrt(power) as weight in the polyfit() function.
Default : True</p>
</dd>
<dt><strong>rm_rdisc</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Whether or not to remove the rain/no-rain disconituity. It assumes no-rain
pixels are assigned with lowest value.
Default : True</p>
</dd>
<dt><strong>doplot</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">Plot the fit.
Default : False</p>
</dd>
<dt><strong>fft_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">A string or a (function,kwargs) tuple defining the FFT method to use
(see utils.fft.get_method). Defaults to “numpy”.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="pysteps-noise-motion">
<h2>pysteps.noise.motion<a class="headerlink" href="#pysteps-noise-motion" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.noise.motion.initialize_bps" title="pysteps.noise.motion.initialize_bps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">initialize_bps</span></code></a>(V,&nbsp;pixelsperkm,&nbsp;timestep[,&nbsp;…])</td>
<td>Initialize the motion field perturbator described in [BPS2006].</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.noise.motion.generate_bps" title="pysteps.noise.motion.generate_bps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">generate_bps</span></code></a>(perturbator,&nbsp;t)</td>
<td>Generate a motion perturbation field by using the method described in [BPS2006].</td>
</tr>
</tbody>
</table>
<span class="target" id="module-pysteps.noise.motion"></span><p>Methods for generating perturbations of two-dimensional motion fields.</p>
<p>The methods in this module implement the following interface for initialization:</p>
<blockquote>
<div>inizialize_xxx(V, pixelsperkm, timestep, optional arguments)</div></blockquote>
<p>where V (2,m,n) is the motion field and pixelsperkm and timestep describe the
spatial and temporal resolution of the motion vectors.
The output of each initialization method is a dictionary containing the perturbator
that can be supplied to generate_xxx.</p>
<p>The methods in this module implement the following interface for the generation
of a motion perturbation field:</p>
<blockquote>
<div>generate_xxx(perturbator, t, randstate=np.random, seed=None)</div></blockquote>
<p>where perturbator is a dictionary returned by an initialize_xxx method. Optional
random generator can be specified with the randstate and seed arguments,
respectively.
The output of each generator method is an array of shape (2,m,n) containing the
x- and y-components of the motion vector perturbations, where m and n are
determined from the perturbator.</p>
<dl class="function">
<dt id="pysteps.noise.motion.generate_bps">
<code class="descclassname">pysteps.noise.motion.</code><code class="descname">generate_bps</code><span class="sig-paren">(</span><em>perturbator</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.motion.generate_bps" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a motion perturbation field by using the method described in
[BPS2006].</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>perturbator</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">A dictionary returned by initialize_motion_perturbations_bps.</p>
</dd>
<dt><strong>t</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Lead time for the perturbation field (minutes).</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array of shape (2,m,n) containing the x- and y-components of the motion
vector perturbations, where m and n are determined from the perturbator.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pysteps.noise.motion.initialize_bps" title="pysteps.noise.motion.initialize_bps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pysteps.noise.motion.initialize_bps</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.motion.get_default_params_bps_par">
<code class="descclassname">pysteps.noise.motion.</code><code class="descname">get_default_params_bps_par</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.motion.get_default_params_bps_par" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the default velocity perturbation parameters
given in [BPS2006] for the parallel component.</p>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.motion.get_default_params_bps_perp">
<code class="descclassname">pysteps.noise.motion.</code><code class="descname">get_default_params_bps_perp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.motion.get_default_params_bps_perp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a tuple containing the default velocity perturbation parameters
given in [BPS2006] for the perpendicular component.</p>
</dd></dl>

<dl class="function">
<dt id="pysteps.noise.motion.initialize_bps">
<code class="descclassname">pysteps.noise.motion.</code><code class="descname">initialize_bps</code><span class="sig-paren">(</span><em>V</em>, <em>pixelsperkm</em>, <em>timestep</em>, <em>p_pert_par=None</em>, <em>p_pert_perp=None</em>, <em>randstate=&lt;module 'numpy.random' from '/top/college/academic/ECE/spulkkin/home/anaconda3/lib/python3.7/site-packages/numpy/random/__init__.py'&gt;</em>, <em>seed=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.motion.initialize_bps" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the motion field perturbator described in [BPS2006].
For simplicity, the bias adjustment procedure described there has not been
implemented. The perturbator generates a constant field whose magnitude
depends on lead time.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>V</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of shape (2,m,n) containing the x- and y-components of the m*n
motion field to perturb.</p>
</dd>
<dt><strong>p_pert_par</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">Tuple containing the parameters a,b and c for the standard deviation of
the perturbations in the direction parallel to the motion vectors. The
standard deviations are modeled by the function f_par(t) = a*t**b+c, where
t is lead time. The default values are taken from [BPS2006].</p>
</dd>
<dt><strong>p_pert_perp</strong> <span class="classifier-delimiter">:</span> <span class="classifier">tuple</span></dt>
<dd><p class="first last">Tuple containing the parameters a,b and c for the standard deviation of
the perturbations in the direction perpendicular to the motion vectors.
The standard deviations are modeled by the function f_par(t) = a*t**b+c,
where t is lead time. The default values are taken from [BPS2006].</p>
</dd>
<dt><strong>pixelsperkm</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Spatial resolution of the motion field (pixels/kilometer).</p>
</dd>
<dt><strong>timestep</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Time step for the motion vectors (minutes).</p>
</dd>
<dt><strong>randstate</strong> <span class="classifier-delimiter">:</span> <span class="classifier">mtrand.RandomState</span></dt>
<dd><p class="first last">Optional random generator to use. If set to None, use numpy.random.</p>
</dd>
<dt><strong>seed</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">Optional seed number for the random generator.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">A dictionary containing the perturbator that can be supplied to
generate_motion_perturbations_bps.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pysteps.noise.motion.generate_bps" title="pysteps.noise.motion.generate_bps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pysteps.noise.motion.generate_bps</span></code></a></p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pysteps.noise.utils">
<span id="pysteps-noise-utils"></span><h2>pysteps.noise.utils<a class="headerlink" href="#module-pysteps.noise.utils" title="Permalink to this headline">¶</a></h2>
<p>Miscellaneous utility functions related to generation of stochastic perturbations.</p>
<dl class="function">
<dt id="pysteps.noise.utils.compute_noise_stddev_adjs">
<code class="descclassname">pysteps.noise.utils.</code><code class="descname">compute_noise_stddev_adjs</code><span class="sig-paren">(</span><em>R</em>, <em>R_thr_1</em>, <em>R_thr_2</em>, <em>F</em>, <em>decomp_method</em>, <em>num_iter</em>, <em>conditional=True</em>, <em>num_workers=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.noise.utils.compute_noise_stddev_adjs" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply a scale-dependent adjustment factor to the noise fields used in STEPS.</p>
<p>Simulates the effect of applying a precipitation mask to a Gaussian noise
field obtained by the nonparametric filter method. The idea is to decompose
the masked noise field into a cascade and compare the standard deviations
of each level into those of the observed precipitation intensity field.
This gives correction factors for the standard deviations [BPS2006].
The calculations are done for n realizations of the noise field, and the
correction factors are calculated from the average values of the standard
deviations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>R</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">The input precipitation field, assumed to be in logarithmic units
(dBR or reflectivity).</p>
</dd>
<dt><strong>R_thr_1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Intensity threshold for precipitation/no precipitation.</p>
</dd>
<dt><strong>R_thr_2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Intensity values below R_thr_1 are set to this value.</p>
</dd>
<dt><strong>F</strong> <span class="classifier-delimiter">:</span> <span class="classifier">dict</span></dt>
<dd><p class="first last">A bandpass filter dictionary returned by a method defined in
pysteps.cascade.bandpass_filters. This defines the filter to use and
the number of cascade levels.</p>
</dd>
<dt><strong>decomp_method</strong> <span class="classifier-delimiter">:</span> <span class="classifier">function</span></dt>
<dd><p class="first last">A function defined in pysteps.cascade.decomposition. Specifies the
method to use for decomposing the observed precipitation field and
noise field into different spatial scales.</p>
</dd>
<dt><strong>num_iter</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of noise fields to generate.</p>
</dd>
<dt><strong>conditional</strong> <span class="classifier-delimiter">:</span> <span class="classifier">bool</span></dt>
<dd><p class="first last">If set to True, compute the statistics conditionally by excluding areas
of no precipitation.</p>
</dd>
<dt><strong>num_workers</strong> <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd><p class="first last">The number of workers to use for parallel computation. Set to None to
use all available CPUs. Applicable if dask is enabled.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd><p class="first last">A list containing the standard deviation adjustment factor for each
cascade level.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="cascade.html"
                        title="previous chapter">Scale-based decomposition of precipitation fields (<code class="docutils literal notranslate"><span class="pre">pysteps.cascade</span></code>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="postprocessing.html"
                        title="next chapter">Post-processing of forecasts (<code class="docutils literal notranslate"><span class="pre">pysteps.postprocessing</span></code>)</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-processing of forecasts (pysteps.postprocessing)"
             >next</a> |</li>
        <li class="right" >
          <a href="cascade.html" title="Scale-based decomposition of precipitation fields (pysteps.cascade)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysteps 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Seppo Pulkkinen, Daniele Nerini and Loris Foresti.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>