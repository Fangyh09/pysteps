
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Time series modeling and analysis (pysteps.timeseries) &#8212; pysteps 0.2 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Miscellaneous utility functions (pysteps.utils)" href="utils.html" />
    <link rel="prev" title="Post-processing of forecasts (pysteps.postprocessing)" href="postprocessing.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utils.html" title="Miscellaneous utility functions (pysteps.utils)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-processing of forecasts (pysteps.postprocessing)"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysteps 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="time-series-modeling-and-analysis-pysteps-timeseries">
<span id="pysteps-timeseries"></span><h1>Time series modeling and analysis (<code class="xref py py-mod docutils literal notranslate"><span class="pre">pysteps.timeseries</span></code>)<a class="headerlink" href="#time-series-modeling-and-analysis-pysteps-timeseries" title="Permalink to this headline">¶</a></h1>
<p>Methods and models for time series analysis. Currently the module contains
implementation of an autoregressive AR(p) model and methods for estimating
the model parameters.</p>
<div class="section" id="pysteps-timeseries-autoregression">
<h2>pysteps.timeseries.autoregression<a class="headerlink" href="#pysteps-timeseries-autoregression" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.timeseries.autoregression.adjust_lag2_corrcoef1" title="pysteps.timeseries.autoregression.adjust_lag2_corrcoef1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adjust_lag2_corrcoef1</span></code></a>(gamma_1,&nbsp;gamma_2)</td>
<td>A simple adjustment of lag-2 temporal autocorrelation coefficient to ensure that the resulting AR(2) process is stationary when the parameters  are estimated from the Yule-Walker equations.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.timeseries.autoregression.adjust_lag2_corrcoef2" title="pysteps.timeseries.autoregression.adjust_lag2_corrcoef2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">adjust_lag2_corrcoef2</span></code></a>(gamma_1,&nbsp;gamma_2)</td>
<td>A more advanced adjustment of lag-2 temporal autocorrelation coefficient  to ensure that the resulting AR(2) process is stationary when the parameters  are estimated from the Yule-Walker equations.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pysteps.timeseries.autoregression.estimate_ar_params_yw" title="pysteps.timeseries.autoregression.estimate_ar_params_yw"><code class="xref py py-obj docutils literal notranslate"><span class="pre">estimate_ar_params_yw</span></code></a>(gamma)</td>
<td>Estimate the parameters of an AR(p) model from the Yule-Walker equations using the given set of autocorrelation coefficients.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pysteps.timeseries.autoregression.iterate_ar_model" title="pysteps.timeseries.autoregression.iterate_ar_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">iterate_ar_model</span></code></a>(X,&nbsp;phi[,&nbsp;EPS])</td>
<td>Apply an AR(p) model to a time-series of two-dimensional fields.</td>
</tr>
</tbody>
</table>
<span class="target" id="module-pysteps.timeseries.autoregression"></span><p>Methods related to autoregressive AR(p) models.</p>
<dl class="function">
<dt id="pysteps.timeseries.autoregression.adjust_lag2_corrcoef1">
<code class="descclassname">pysteps.timeseries.autoregression.</code><code class="descname">adjust_lag2_corrcoef1</code><span class="sig-paren">(</span><em>gamma_1</em>, <em>gamma_2</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.timeseries.autoregression.adjust_lag2_corrcoef1" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple adjustment of lag-2 temporal autocorrelation coefficient to
ensure that the resulting AR(2) process is stationary when the parameters 
are estimated from the Yule-Walker equations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>gamma_1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Lag-1 temporal autocorrelation coeffient.</p>
</dd>
<dt><strong>gamma_2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Lag-2 temporal autocorrelation coeffient.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The adjusted lag-2 correlation coefficient.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.timeseries.autoregression.adjust_lag2_corrcoef2">
<code class="descclassname">pysteps.timeseries.autoregression.</code><code class="descname">adjust_lag2_corrcoef2</code><span class="sig-paren">(</span><em>gamma_1</em>, <em>gamma_2</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.timeseries.autoregression.adjust_lag2_corrcoef2" title="Permalink to this definition">¶</a></dt>
<dd><p>A more advanced adjustment of lag-2 temporal autocorrelation coefficient 
to ensure that the resulting AR(2) process is stationary when the parameters 
are estimated from the Yule-Walker equations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>gamma_1</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Lag-1 temporal autocorrelation coeffient.</p>
</dd>
<dt><strong>gamma_2</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">Lag-2 temporal autocorrelation coeffient.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd><p class="first last">The adjusted lag-2 correlation coefficient.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.timeseries.autoregression.estimate_ar_params_yw">
<code class="descclassname">pysteps.timeseries.autoregression.</code><code class="descname">estimate_ar_params_yw</code><span class="sig-paren">(</span><em>gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.timeseries.autoregression.estimate_ar_params_yw" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimate the parameters of an AR(p) model from the Yule-Walker equations
using the given set of autocorrelation coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>gamma</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of length p containing the lag-l, l=1,2,…p, temporal autocorrelation
coefficients. The correlation coefficients are assumed to be in ascending
order with respect to time lag.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">An array of shape (n,p+1) containing the AR(p) parameters for for the
lag-p terms for each cascade level, and also the standard deviation of
the innovation term.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pysteps.timeseries.autoregression.iterate_ar_model">
<code class="descclassname">pysteps.timeseries.autoregression.</code><code class="descname">iterate_ar_model</code><span class="sig-paren">(</span><em>X</em>, <em>phi</em>, <em>EPS=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.timeseries.autoregression.iterate_ar_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply an AR(p) model to a time-series of two-dimensional fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Three-dimensional array of shape (p,w,h) containing a time series of p
two-dimensional fields of shape (w,h). The fields are assumed to be in
ascending order by time, and the timesteps are assumed to be regular.</p>
</dd>
<dt><strong>phi</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Array of length p+1 specifying the parameters of the AR(p) model. The
parameters are in ascending order by increasing time lag, and the last
element is the parameter corresponding to the innovation term EPS.</p>
</dd>
<dt><strong>EPS</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Optional perturbation field for the AR(p) process. If EPS is None, the
innovation term is not added.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pysteps.timeseries.correlation">
<span id="pysteps-timeseries-correlation"></span><h2>pysteps.timeseries.correlation<a class="headerlink" href="#module-pysteps.timeseries.correlation" title="Permalink to this headline">¶</a></h2>
<p>Methods for computing spatial and temporal correlation of time series of
two-dimensional fields.</p>
<dl class="function">
<dt id="pysteps.timeseries.correlation.temporal_autocorrelation">
<code class="descclassname">pysteps.timeseries.correlation.</code><code class="descname">temporal_autocorrelation</code><span class="sig-paren">(</span><em>X</em>, <em>MASK=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pysteps.timeseries.correlation.temporal_autocorrelation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute lag-l autocorrelation coefficients gamma_l, l=1,2,…,n-1, for a
time series of n two-dimensional input fields.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><dl class="first docutils">
<dt><strong>X</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Two-dimensional array of shape (n, w, h) containing a time series of n
two-dimensional fields of shape (w, h). The input fields are assumed to
be in increasing order with respect to time, and the time step is assumed
to be regular (i.e. no missing data). X is required to have finite values.</p>
</dd>
<dt><strong>MASK</strong> <span class="classifier-delimiter">:</span> <span class="classifier">array_like</span></dt>
<dd><p class="first last">Optional mask to use for computing the correlation coefficients. Pixels
with MASK==False are excluded from the computations.</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><dl class="first last docutils">
<dt><strong>out</strong> <span class="classifier-delimiter">:</span> <span class="classifier">ndarray</span></dt>
<dd><p class="first last">Array of length n-1 containing the temporal autocorrelation coefficients
for time lags l=1,2,…,n-1.</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="postprocessing.html"
                        title="previous chapter">Post-processing of forecasts (<code class="docutils literal notranslate"><span class="pre">pysteps.postprocessing</span></code>)</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="utils.html"
                        title="next chapter">Miscellaneous utility functions (<code class="docutils literal notranslate"><span class="pre">pysteps.utils</span></code>)</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="utils.html" title="Miscellaneous utility functions (pysteps.utils)"
             >next</a> |</li>
        <li class="right" >
          <a href="postprocessing.html" title="Post-processing of forecasts (pysteps.postprocessing)"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pysteps 0.2 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Seppo Pulkkinen, Daniele Nerini and Loris Foresti.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.
    </div>
  </body>
</html>